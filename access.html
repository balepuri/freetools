<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Access Your Free Resources</title>
  <!-- Preconnect and Import Lexend Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Base Styles */
    body {
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
      font-family: 'Lexend', sans-serif;
      text-align: center;
    }
    /* Container for Intro & Form */
    .container {
      max-width: 600px;
      margin: 30px auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      opacity: 0;
      animation: fadeIn 0.6s forwards;
    }
    /* Fade In Effect */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    /* Headline Styles */
    .headline1 {
      font-size: 28px;
      font-weight: bold;
      color: #FF0000;
      margin-bottom: 15px;
    }
    .headline2 {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    /* Description Text */
    .description {
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 20px;
    }
    /* Button Styles */
    .start-button,
    .next-button,
    .submit-button,
    .option-button,
    .sudah-button,
    .tidak-button {
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px auto;
      padding: 15px;
      width: 90%;
      max-width: 500px;
      transition: background 0.3s ease;
      font-size: 18px;
      display: block;
    }
    .start-button {
      background-color: green;
      color: white;
      font-weight: bold;
    }
    .next-button,
    .submit-button,
    .sudah-button {
      background-color: blue;
      color: white;
      font-weight: bold;
    }
    .tidak-button {
      background-color: red;
      color: white;
      font-weight: bold;
    }
    .option-button {
      background-color: white;
      border: 2px solid #000;
      border-radius: 8px;
      padding: 15px;
      margin: 10px auto;
      width: 90%;
      max-width: 500px;
      text-align: center;
    }
    .option-button:hover {
      background-color: #ddd;
    }
    /* Input Field Styling */
    .input-field {
      width: 90%;
      max-width: 500px;
      padding: 10px;
      font-size: 18px;
      border: 2px solid #000;
      border-radius: 10px;
      margin: 10px auto;
      display: block;
      text-align: center;
    }
    /* Hide Elements by Default */
    .hidden {
      display: none;
    }
    /* Link Styling */
    .review-link {
      font-size: 18px;
      color: blue;
      text-decoration: underline;
      cursor: pointer;
      display: inline-block;
      margin: 20px 0;
    }
    /* Extra Spacer */
    .spacer {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  
  <!-- Introduction Section -->
  <div class="container" id="introContainer">
    <div class="headline1">Kalo Anda isi form di bawah ini, Anda dapat Akses ke semua Toolsnya!</div>
    <div class="headline2">YUK ISI INI UNTUK DAPETIN 3 TOOLS DARIPADA 1</div>
    <div class="description">
      ✅ 20K+ ChatGPT Prompts to Boost Your Work 1000x Faster<br>
      ✅ 1400+ AI Tools to Boost Your Work 1000x Faster<br>
      ✅ Financial Management to Stop Losing Money Every Month
    </div>
    <button class="start-button" onclick="startForm()">Saya Mau Tools Nya!</button>
  </div>
  
  <!-- Form Section (hidden until start) -->
  <div class="container hidden" id="formContainer">
    <div id="questionContainer">
      <div id="questionText" class="headline2"></div>
    </div>
    <div id="optionsContainer">
      <!-- Options or input fields will be injected here -->
    </div>
    <!-- Next Button for input-based questions -->
    <button class="next-button hidden" id="nextButton" onclick="nextQuestion()">Next</button>
    <!-- Submit Button (appears after Q8 is completed) -->
    <button class="submit-button hidden" id="submitButton" onclick="submitForm()">Submit</button>
  </div>
  
  <!-- JavaScript Section -->
  <script>
    /***************************************
     * Global Variables and Configurations *
     ***************************************/
    
    // Your Google Apps Script web app URL
    const scriptURL = "https://script.google.com/macros/s/AKfycbyYcFecT4xDaH00wEsrSF7hWzXi2LJvcbGNRQ0-96ONtp2hHhiKNrxoqHNkA3m9nFxJ/exec";
    
    // Object to store collected answers
    let formData = {};
    // Current question index
    let currentQuestion = 0;
    
    // Questions Array (with explicit field names to map to your Google Sheet columns)
    const questions = [
      { field: "usia", text: "Usia Anda", type: "input", placeholder: "Tulis Disini" },
      { field: "gender", text: "Gender", type: "multiple", options: ["Laki-laki", "Perempuan", "Yang lain"] },
      { field: "pekerjaan", text: "Status Pekerjaan", type: "multiple", options: ["Karyawan Swasta", "Wiraswasta/Entrepreneur", "Freelancer", "Yang lain"] },
      { field: "gaji", text: "Rata-rata gaji pekerjaan", type: "multiple", options: ["1jt-20jt/bulan", "20jt-50jt/bulan", "50jt-100jt/bulan", "100jt-200jt/bulan", "200jt+/bulan"] },
      { field: "alasan", text: "Apa yang membuat Anda ingin menginap di Bale?", type: "multiple", options: ["Ada acara dekat lokasi", "Desain bangunan bagus", "Ada pekerjaan kantor", "Ingin konsentrasi bekerja", "Bosan di rumah", "Yang lain"] },
      { field: "topik", text: "Bale sangat concern terhadap dunia karir Gen Z dan milenial, dan kami ingin memberikan sumbangsi berupa materi untuk perkembangan tersebut. Topic mana dibawah ini yang sekiranya menarik bagi kamu?", type: "multiple", options: ["Cara kamu bisa membangun bisnis 100jt/bln", "Cara menghasilkan 100jt/bln dengan skill yang sudah kamu punyai", "Cara kita membangun bisnis 500jt/bln", "Cara mencapai kebebasan finansial di dunia karir dan bisnis"] },
      { field: "wa", text: "Maukah Anda mendapatkan update saat materi di release?", type: "wa", placeholder: "Jika Iya, tulis No WA Kamu disini:" },
      { field: "review", text: "Review Hotel Bale Puri Disini untuk mendapatkan 4 Tools GRATIS", type: "review", url: "https://search.google.com/local/writereview?placeid=ChIJm7ZyzD73aS4Rp9VEEs85aoY" }
    ];
    
    /*******************************
     * Functions for Form Control  *
     *******************************/
    
    // Start Form: Hide intro and show the form container
    function startForm() {
      document.getElementById("introContainer").classList.add("hidden");
      document.getElementById("formContainer").classList.remove("hidden");
      currentQuestion = 0;
      formData = {}; // Reset data
      loadQuestion();
    }
    
    // Load the current question based on currentQuestion index
    function loadQuestion() {
      const questionTextEl = document.getElementById("questionText");
      const optionsContainer = document.getElementById("optionsContainer");
      const nextButton = document.getElementById("nextButton");
      const submitButton = document.getElementById("submitButton");
      
      // Hide Next and Submit buttons for each new question
      nextButton.classList.add("hidden");
      submitButton.classList.add("hidden");
      optionsContainer.innerHTML = "";
      
      // Get the current question object
      const questionObj = questions[currentQuestion];
      questionTextEl.textContent = questionObj.text;
      questionTextEl.style.opacity = 0;
      setTimeout(() => { questionTextEl.style.opacity = 1; }, 100);
      
      // Handle question types
      if (questionObj.type === "input") {
        // Q1 (Input)
        const inputField = document.createElement("input");
        inputField.type = "text";
        inputField.placeholder = questionObj.placeholder;
        inputField.className = "input-field";
        // Prevent Enter key from skipping without input
        inputField.addEventListener("keydown", function(e) {
          if (e.key === "Enter") {
            if (this.value.trim() === "") e.preventDefault();
            else e.preventDefault();
          }
        });
        // Show Next button only when there is text
        inputField.addEventListener("input", function() {
          if (this.value.trim() !== "") nextButton.classList.remove("hidden");
          else nextButton.classList.add("hidden");
        });
        inputField.addEventListener("focus", function() {
          if (this.value.trim() !== "") nextButton.classList.remove("hidden");
        });
        optionsContainer.appendChild(inputField);
      
      } else if (questionObj.type === "multiple") {
        // Multiple Choice Questions (Q2, Q3, Q4, Q5, Q6)
        questionObj.options.forEach(option => {
          const btn = document.createElement("button");
          btn.className = "option-button";
          btn.textContent = option;
          btn.style.textAlign = "center";
          btn.addEventListener("click", function() {
            if (option === "Yang lain") {
              // Clear options and show an input for extra text
              optionsContainer.innerHTML = "";
              const extraInput = document.createElement("input");
              extraInput.type = "text";
              extraInput.placeholder = "Tulis Disini";
              extraInput.className = "input-field";
              extraInput.dataset.isExtra = "true";
              extraInput.addEventListener("keydown", function(e) {
                if (e.key === "Enter") {
                  if (this.value.trim() === "") e.preventDefault();
                  else e.preventDefault();
                }
              });
              extraInput.addEventListener("input", function() {
                if (this.value.trim() !== "") nextButton.classList.remove("hidden");
                else nextButton.classList.add("hidden");
              });
              optionsContainer.appendChild(extraInput);
              nextButton.classList.add("hidden");
            } else {
              // Record answer and immediately move to next question
              formData[questionObj.field] = option;
              currentQuestion++;
              loadQuestion();
            }
          });
          optionsContainer.appendChild(btn);
        });
      
      } else if (questionObj.type === "wa") {
        // Q7: WA Update Question (Input + "Tidak Mau" option)
        const waInput = document.createElement("input");
        waInput.type = "text";
        waInput.placeholder = questionObj.placeholder;
        waInput.className = "input-field";
        waInput.addEventListener("keydown", function(e) {
          if (e.key === "Enter") {
            if (this.value.trim() === "") e.preventDefault();
            else e.preventDefault();
          }
        });
        // Create red "Tidak Mau" button
        const tidakBtn = document.createElement("button");
        tidakBtn.className = "tidak-button";
        tidakBtn.textContent = "Tidak Mau";
        tidakBtn.addEventListener("click", function() {
          formData[questionObj.field] = "Tidak diisi";
          currentQuestion++;
          loadQuestion();
        });
        // When input is focused or has text, show Next button and hide "Tidak Mau"
        waInput.addEventListener("focus", function() {
          tidakBtn.classList.add("hidden");
          nextButton.classList.remove("hidden");
        });
        waInput.addEventListener("input", function() {
          if (this.value.trim() !== "") nextButton.classList.remove("hidden");
          else nextButton.classList.add("hidden");
        });
        optionsContainer.appendChild(waInput);
        optionsContainer.appendChild(tidakBtn);
      
      } else if (questionObj.type === "review") {
        // Q8: Review Link Question
        const reviewLink = document.createElement("a");
        reviewLink.href = questionObj.url;
        reviewLink.target = "_blank";
        reviewLink.textContent = "Klik Disini untuk Review";
        reviewLink.className = "review-link";
        optionsContainer.appendChild(reviewLink);
        
        // "Sudah :)" button (styled blue)
        const sudahButton = document.createElement("button");
        sudahButton.className = "sudah-button hidden";
        sudahButton.textContent = "Sudah :)";
        // When clicked, record answer and reveal the Submit button
        sudahButton.addEventListener("click", function() {
          formData[questionObj.field] = "Review Selesai";
          document.getElementById("submitButton").classList.remove("hidden");
        });
        optionsContainer.appendChild(sudahButton);
        
        // Show the "Sudah :)" button shortly after the link is clicked
        reviewLink.addEventListener("click", function() {
          setTimeout(function() {
            sudahButton.classList.remove("hidden");
          }, 300);
        });
      }
    }
    
    // Proceed to Next Question for input-based types (including extra inputs)
    function nextQuestion() {
      const questionObj = questions[currentQuestion];
      const optionsContainer = document.getElementById("optionsContainer");
      const nextButton = document.getElementById("nextButton");
      
      if (questionObj.type === "input" || questionObj.type === "wa") {
        const inputEl = optionsContainer.querySelector("input");
        if (inputEl && inputEl.value.trim() !== "") {
          formData[questionObj.field] = inputEl.value.trim();
        }
      }
      // Check for extra input in multiple choice ("Yang lain")
      if (questionObj.type === "multiple") {
        const extraInput = optionsContainer.querySelector("input[data-isExtra='true']");
        if (extraInput && extraInput.value.trim() !== "") {
          formData[questionObj.field] = extraInput.value.trim();
        }
      }
      
      currentQuestion++;
      // If not the last question, load the next question
      if (currentQuestion < questions.length) {
        loadQuestion();
      } else {
        // For Q8, we want the question to remain visible (Submit button is revealed via "Sudah :)")
        // So we do not call loadQuestion() here.
      }
    }
    
    // Submit the form data to Google Sheets via your Apps Script
    function submitForm() {
      // Send data as JSON so that the Apps Script (Code.gs) can parse it
      fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
      })
      .then(response => {
        // On success, redirect the user to your provided link
        window.location.href = "https://balepuri.github.io/unlockedfree/";
      })
      .catch(error => console.error("Error!", error.message));
    }
    
    /*****************************************
     * Prevent Form Skipping via Enter Key   *
     *****************************************/
    document.addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        const activeEl = document.activeElement;
        if (activeEl.tagName === "INPUT" && activeEl.value.trim() === "") {
          e.preventDefault();
        }
      }
    });
    
    /*****************************************
     * Extra: Smooth Fade Transition on Load *
     *****************************************/
    function applyFadeEffect(element) {
      element.style.opacity = 0;
      setTimeout(() => {
        element.style.transition = "opacity 0.5s ease-in-out";
        element.style.opacity = 1;
      }, 50);
    }
    
    // End of Script
  </script>
  
  <!-- Spacer for Visual Separation -->
  <div class="spacer"></div>
  
  <!-- Additional Comments:
       - The questions are mapped with explicit field names to match your Google Sheets columns:
         Column B: Usia, C: Gender, D: Pekerjaan, E: Gaji, F: Alasan, G: Topik, H: WA, I: Review.
       - The submitForm() function sends the collected data as JSON.
       - Your provided Code.gs looks correct. Just ensure that the sheet’s column order matches the appended row:
           new Date(), data.usia, data.gender, data.pekerjaan, data.gaji, data.alasan, data.topik, data.wa || "Tidak diisi", data.review
       - If any adjustments are needed in Code.gs, they would likely be around how the incoming data is parsed.
  -->
  
</body>
</html>
